<!doctype html>
<html class="no-js" lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>
    
  UIApplication - DreamEverAfter
  
  </title>
  
  
  <link href="atom.xml" rel="alternate" title="DreamEverAfter" type="application/atom+xml">
    <link rel="stylesheet" href="asset/css/foundation.min.css" />
    <link rel="stylesheet" href="asset/css/docs.css" />
    <script src="asset/js/vendor/modernizr.js"></script>
    <script src="asset/js/vendor/jquery.js"></script>
 
<script type="text/javascript">
  function before_search(){
    var searchVal = 'site:www.dreameverafter.com ' + document.getElementById('search_input').value;
    document.getElementById('search_q').value = searchVal;
    return true;
  }
</script>
  </head>
  <body class="antialiased hide-extras">
    
    <div class="marketing off-canvas-wrap" data-offcanvas>
      <div class="inner-wrap">


<nav class="top-bar docs-bar hide-for-small" data-topbar>


  <section class="top-bar-section">
  <div class="row">
      <div style="position: relative;width:100%;"><div style="position: absolute; width:100%;">
        <ul id="main-menu" class="left">
        
        <li id=""><a target="_self" href="index.html">Home</a></li>
        
        <li id=""><a target="_self" href="archives.html">Archives</a></li>
        
        <li id=""><a target="_self" href="tools.html">工具</a></li>
        
        <li id=""><a target="_self" href="about.html">About</a></li>
        
        </ul>

        <ul class="right" id="search-wrap">
          <li>
<form target="_blank" onsubmit="return before_search();" action="https://google.com/search" method="get">
    <input type="hidden" id="search_q" name="q" value="" />
    <input tabindex="1" type="search" id="search_input"  placeholder="Search"/>
</form>
</li>
          </ul>
      </div></div>
  </div>
  </section>

</nav>

        <nav class="tab-bar show-for-small">
  <a href="javascript:void(0)" class="left-off-canvas-toggle menu-icon">
    <span> &nbsp; DreamEverAfter</span>
  </a>
</nav>

<aside class="left-off-canvas-menu">
      <ul class="off-canvas-list">
        
        <li><a target="_self" href="index.html">Home</a></li>
        
        <li><a target="_self" href="archives.html">Archives</a></li>
        
        <li><a target="_self" href="tools.html">工具</a></li>
        
        <li><a target="_self" href="about.html">About</a></li>
        

    <li><label>Categories</label></li>

        
            <li><a href="Pages.html">Pages</a></li>
        
            <li><a href="CS.html">CS</a></li>
        
            <li><a href="List.html">List</a></li>
        
            <li><a href="%E6%9D%82.html">杂</a></li>
         

      </ul>
    </aside>

<a class="exit-off-canvas" href="#"></a>


        <section id="main-content" role="main" class="scroll-container">
        
       

 <script type="text/javascript">
  $(function(){
    $('#menu_item_index').addClass('is_active');
  });
</script>
<div class="row">
  <div class="large-8 medium-8 columns">
      <div class="markdown-body article-wrap">
       <div class="article">
          
          <h1>UIApplication</h1>
     
        <div class="read-more clearfix">
          <span class="date">2016/05/21</span>

          <span>posted in&nbsp;</span> 
          
              <span class="posted-in"><a href='UI.html'>UI</a></span>
           
         
          <span class="comments">
            

            
          </span>

        </div>
      </div><!-- article -->

      <div class="article-content">
      <h3><a id="1-uiapplication%E5%8E%9F%E7%90%86" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>1.UIApplication原理</h3>
<p>UIApplication对象是应用程序的象征, 每一个应用都有自己的UIApplication对象,这个对象是系统自动帮我们创建的, 而且是单例的.<br />
一个 iOS 程序启动后创建的第一个对象就是 <code>UIApplication</code>对象,利用  <code>UIApplication</code></p>
<p>对象,能进行一些应用级别的操作,比如:可以设置应用程序图标右上角的红色提醒数字设置联网指示器的可见性可以设置应用程序的状态栏，进行应用之间的跳转.</p>
<span id="more"></span><!-- more -->
<h3><a id="2-uiapplication%E8%8E%B7%E5%8F%96" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>2.UIApplication获取</h3>
<p>通过 <code>[UIApplication sharedApplication]</code> 可以获得这个单例对象</p>
<h3><a id="3-uiapplication%E7%9A%84%E5%B8%B8%E7%94%A8%E5%B1%9E%E6%80%A7" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>3.UIApplication的常用属性</h3>
<p>设置应用程序图标右上角的红色提醒数字</p>
<pre><code class="language-swift">/// 获取UIApplication对象
UIApplication *ap = [UIApplication sharedApplication];
/// 在设置之前, 要注册一个通知,从ios8之后,都要先注册一个通知对象.才能够接收到提醒.
UIUserNotificationSettings *notice = [UIUserNotificationSettings settingsForTypes:UIUserNotificationTypeBadge categories:nil];
/// 注册通知对象
[ap registerUserNotificationSettings:notice];
/// 设置提醒数字
ap.applicationIconBadgeNumber = 20;
</code></pre>
<p><img src="media/17001892554030/17001903751422.png" alt="" /></p>
<p>设置联网指示器的可见性</p>
<pre><code class="language-swift">@property(nonatomic,getter=isNetworkActivityIndicatorVisible) BOOL networkActivityIndicatorVisible;
</code></pre>
<p>应用程序状态</p>
<pre><code class="language-swift">@property(nonatomic,readonly) UIApplicationState applicationState;

typedef NS_ENUM(NSInteger, UIApplicationState) {
    UIApplicationStateActive,
    UIApplicationStateInactive,
    UIApplicationStateBackground
}
</code></pre>
<p>设置连网状态</p>
<pre><code class="language-swift">ap.networkActivityIndicatorVisible = YES;
</code></pre>
<p><img src="media/17001892554030/17001903751432.png" alt="" /></p>
<h3><a id="4-uiapplication%E7%AE%A1%E7%90%86%E7%8A%B6%E6%80%81%E6%A0%8F" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>4.UIApplication管理状态栏</h3>
<p>从iOS7开始，系统提供了2种管理状态栏的方式:</p>
<pre><code class="language-plain_text">1. 通过 `UIViewController`管理（每一个`UIViewController`都可以拥有自己不同的状态栏）


2. 通过 `UIApplication`管理（一个应用程序的状态栏都由它统一管理）
</code></pre>
<p>在iOS7中，默认情况下，状态栏都是由<code>UIViewController</code>管理的， <code>UIViewController</code>实现下列方法就可以轻松管理状态栏的可见性和样式.</p>
<p>状态栏的样式:<br />
<code>- (UIStatusBarStyle)preferredStatusBarStyle;</code></p>
<p>状态栏的可见性:<br />
<code>- (BOOL)prefersStatusBarHidden;</code></p>
<p>如果想利用<code>UIApplication</code></p>
<p>来管理状态栏，首先得修改Info.plist的设置</p>
<p><img src="media/17001892554030/17001903751440.jpg" alt="" /></p>
<h3><a id="5-uiapplication%E6%9C%89%E4%B8%AA%E5%8A%9F%E8%83%BD%E5%8D%81%E5%88%86%E5%BC%BA%E5%A4%A7%E7%9A%84openurl%E6%96%B9%E6%B3%95" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>5.UIApplication有个功能十分强大的openURL:方法</h3>
<pre><code class="language-swift">- (BOOL)openURL:(NSURL*)url;
</code></pre>
<p><code>openURL:</code>方法的部分功能有:</p>
<h4><a id="%E6%89%93%E7%94%B5%E8%AF%9D" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>打电话</h4>
<p>打电话有三种实现方式，每个都有点区别，分别说一下。</p>
<pre><code class="language-swift">// 最简单直接的方式，直接跳到拨号界面
UIApplication *app = [UIApplication sharedApplication];
[app openURL:[NSURL URLWithString:@&quot;tel://10086&quot;]];
// 这个方式的缺点是打完电话不会自动回到原应用，直接停留在通话记录界面。

// 拨号之前会弹框询问用户是否拨号，拨完后能自动回到原应用
UIApplication *app = [UIApplication sharedApplication];
[app openURL:[NSURL URLWithString:@&quot;telprompt://10086&quot;]];
// 这个方式的缺点是用的私有的 API，所以可能不会被审核通过。

//  创建一个 UIWebView 来加载 URl， 拨完后能自动回到原应用
if (_webView == nil) {
    _webView = [[UIWebView alloc] initWithFrame:CGRectZero];
}
[_webView loadRequest:[NSURLRequest requestWithURL:[NSURL URLWithString:@&quot;tel://10010&quot;]]];
// 需要注意的是：这个webView千万不要添加到界面上来，不然会挡住其他界面
// 电话号码不能有空格。
</code></pre>
<h4><a id="%E5%8F%91%E7%9F%AD%E4%BF%A1" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>发短信</h4>
<p>发短信也有两种实现方式。</p>
<pre><code class="language-swift">// 直接跳转到发短信界面
UIApplication *app = [UIApplication sharedApplication];
[app openURL:[NSURL URLWithString:@&quot;sms://10086&quot;]];
// 这样不能指定短信内容，而且不能自动回到原应用。

// 使用 MessageUI 框架
// 如果想指定短信内容，那就得使用 MessageUI 框架。
//包含主头文件 
#import &lt;MessageUI/MessageUI.h &gt; 

// 显示发短信的控制器
MFMessageComposeViewController *vc = [[MFMessageComposeViewController alloc] init];
// 设置短信内容
vc.body = @&quot;吃饭了没？&quot;;
// 设置收件人列表
vc.recipients = @[@&quot;10010&quot;, @&quot;02010010&quot;];
// 设置代理
vc.messageComposeDelegate = self;
// 显示控制器
[self presentViewController:vc animated:YES completion:nil];

// 代理方法，当短信界面关闭的时候调用，发完后会自动回到原应用
- (void)messageComposeViewController:(MFMessageComposeViewController*)controller didFinishWithResult:(MessageComposeResult)result
{
    // 关闭短信界面
    [controller dismissViewControllerAnimated:YES completion:nil];
    if(result == MessageComposeResultCancelled) {
        NSLog(@&quot;取消发送&quot;);
      } else if(result == MessageComposeResultSent) {
        NSLog(@&quot;已经发出&quot;);
    } else {
        NSLog(@&quot;发送失败&quot;);
    }
}
</code></pre>
<h4><a id="%E5%8F%91%E9%82%AE%E4%BB%B6" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>发邮件</h4>
<pre><code class="language-swift">[app openURL:[NSURL URLWithString:@&quot;mailto://12345@qq.com&quot;]];
</code></pre>
<p>这样发完邮件后不会自动回到原应用。</p>
<p>下面方法可以解决此问题：</p>
<pre><code class="language-swift">  
// 通过 MFMailComposeViewController 发邮件

// 1，发邮件


    // 不能发邮件
    if (![MFMailComposeViewController canSendMail])
        return;

    MFMailComposeViewController *vc = [[MFMailComposeViewController alloc] init];

    // 设置邮件主题
    [vc setSubject:@&quot;会议&quot;];
    // 设置邮件内容
    [vc setMessageBody:@&quot;今天下午开会吧&quot; isHTML:NO];
    // 设置收件人列表
    [vc setToRecipients:@[@&quot;XXXX@qq.com&quot;]];
    // 设置抄送人列表
    [vc setCcRecipients:@[@&quot;1234@qq.com&quot;]];
    // 设置密送人列表
    [vc setBccRecipients:@[@&quot;56789@qq.com&quot;]];

    // 添加附件（一张图片）
    UIImage *image = [UIImage imageNamed:@&quot;xxx.png&quot;];
    NSData *data = UIImagePNGRepresentation(image);
    [vc addAttachmentData:data mimeType:@&quot;image/png&quot; fileName:@&quot;xxx.png&quot;];

    // 设置代理
    vc.mailComposeDelegate = self;
    // 显示控制器
    [self presentViewController:vc animated:YES completion:nil];

// 2，发邮件代理方法,邮件发送后的代理方法回调，发完后会自动回到原应用

    - (void)mailComposeController:(MFMailComposeViewController*)controller didFinishWithResult:(MFMailComposeResult)result error:(NSError*)error
    {
        // 关闭邮件界面
        [controller dismissViewControllerAnimated:YES completion:nil];

        if(result == MFMailComposeResultCancelled) {
            NSLog(@&quot;取消发送&quot;);
        } else if(result == MFMailComposeResultSent) {
            NSLog(@&quot;已经发出&quot;);
        } else {
            NSLog(@&quot;发送失败&quot;);
        }
    }


</code></pre>
<h4><a id="%E6%89%93%E5%BC%80%E4%B8%80%E4%B8%AA%E7%BD%91%E9%A1%B5%E8%B5%84%E6%BA%90" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>打开一个网页资源</h4>
<pre><code class="language-swift">[app openURL:[NSURL URLWithString:@&quot;http://ios.itcast.cn&quot;]];
</code></pre>
<h4><a id="%E6%89%93%E5%BC%80%E5%85%B6%E4%BB%96app%E7%A8%8B%E5%BA%8F" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>打开其他 app 程序</h4>
<h5><a id="%E6%B3%A8%E5%86%8C%E8%87%AA%E5%AE%9A%E4%B9%89url%E5%8D%8F%E8%AE%AE" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>注册自定义URL协议</h5>
<p>首先被启动的应用需要向iPhone注册一个自定义URL协议。这是在你的项目文件夹的<code>info.plist</code></p>
<p>文件进行的（就是你改变应用程序图标的同一个文件）。</p>
<p>1 .右键，选择“Add Row”<br />
2 .Key值选择“URL types”<br />
3 .打开“Item 0″,然后为该key增加一个URL identifier。可以是任何值，但建议用“反域名”(例如 “com.fcplayer.testHello”)。<br />
4 .在“Item 0”下再加一行。<br />
5 .选择“URL Schemes” 作为Key。<br />
6 .输入你的URL协议名 (例如“testHello://”应写做“testHello”)。如果有必要，你可以在这里加入多个协议。</p>
<p>操作截图如下：</p>
<p><img src="media/17001892554030/17001903751446.jpg" alt="" /></p>
<h5><a id="%E8%AE%BF%E9%97%AE%E8%87%AA%E5%AE%9A%E4%B9%89url" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>访问自定义URL</h5>
<pre><code class="language-swift">NSURL * myURL_APP_A = [NSURL URLWithString:@&quot;testHello://&quot;];
if ([[UIApplication sharedApplication] canOpenURL:myURL_APP_A]) {
    NSLog(@&quot;canOpenURL&quot;);
    [[UIApplication sharedApplication] openURL:myURL_APP_A];
}
</code></pre>
<h5><a id="%E8%87%AA%E5%AE%9A%E4%B9%89%E5%A4%84%E7%90%86url" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>自定义处理URL</h5>
<p>有些时候我们除了启动还需向另外一个应用发送参数，这是也可以通过自定义的URL来实现，如：</p>
<pre><code class="language-swift">testHello://
testHello://com.fcplayer.testHello
testHello://config=1&amp;abar=2
</code></pre>
<p>这时我们在被启动应用中就必须进行自定义处理，在delegate中实现该消息(Cocos2d加在AppDelegate中)，例如：</p>
<pre><code class="language-swift">- (BOOL)application:(UIApplication *)application handleOpenURL:(NSURL*)url
{
    // Do something withthe url here
}
</code></pre>
<h4><a id="%E5%BA%94%E7%94%A8%E8%AF%84%E5%88%86%E5%8A%9F%E8%83%BD" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>应用评分功能</h4>
<p>为了提高应用的用户体验，经常需要邀请用户对应用进行评分。</p>
<p>应用评分无非就是跳转到AppStore展示自己的应用，然后由用户自己撰写评论<br />
如何跳转到AppStore，并且展示自己的应用。</p>
<h5><a id="%E6%96%B9%E6%B3%951" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>方法1</h5>
<pre><code class="language-swift">NSString *appid = @&quot;xxxx&quot;; 
NSString *str = [NSString stringWithFormat: @&quot;itms-apps://ax.itunes.apple.com/WebObjects/MZStore.woa/wa/viewContentsUserReviews?type=Purple+Software&amp;id=%@&quot;, appid];
[[UIApplication sharedApplication] openURL:[NSURL URLWithString:str]];
</code></pre>
<h5><a id="%E6%96%B9%E6%B3%952" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>方法2</h5>
<pre><code class="language-swift">NSString *str = [NSString stringWithFormat: @&quot;itms-apps://itunes.apple.com/cn/app/id%@?mt=8&quot;, appid];
[[UIApplication sharedApplication] openURL:[NSURL URLWithString:str]];
</code></pre>
<h2><a id="uiapplicationmain" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>UIApplicationMain</h2>
<p>main函数中执行了一个UIApplicationMain这个函数</p>
<pre><code class="language-swift">UIKIT_EXTERN int UIApplicationMain(int argc, char *argv[], NSString * __nullable principalClassName, NSString * __nullable delegateClassName);
</code></pre>
<p>argc,argv: 直接传递给<code>UIApplicationMain</code>进行相关处理即可。</p>
<p>principalClassName: 指定应用程序类名(APP的象征), 该类必须是UIApplicationMain(或子类),如果为nil,则用UIApplication类作为默认值。</p>
<p>delegateClassName: 指定应用程序的代理类,该类必须遵守UIApplicationDelegate协议。</p>
<p><code>UIApplicationMain</code>函数会根据<code>principalClassName</code>创建<code>UIApplication</code>对象,根据<code>delegateClassName</code>创建一个<code>delegate</code>对象,并将该<code>delegate</code>对象赋值给<code>UIApplication</code>对象中的<code>delegate</code>属性。</p>
<p>接着会建立应用程序的Main Runloop(时间循环),进行事件的处理(首先会在程序完毕后调用<code>delegate</code>对象的<code>application:didFinishLaunchingWithOptions</code>方法)。</p>
<p>程序正常退出时<code>UIApplicationMain</code>函数才返回。</p>
<h3><a id="%E7%A8%8B%E5%BA%8F%E5%AE%8C%E6%95%B4%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>程序完整启动流程</h3>
<ol>
<li>执行Main</li>
<li>执行UIApplicationMain函数.</li>
<li>创建UIApplication对象,并设置UIApplicationMain对象的代理.UIApplication的第三个参数就是UIApplication的名称,如果指定为nil,它会默认 为UIApplication.UIApplication的第四个参数为UIApplication的代理.</li>
<li>开启一个主运行循环.保证应用程序不退出.</li>
<li>加载info.plist.加载配置文文件.判断一下info.plist文件当中有没有Main storyboard file base name里面有没有指定storyboard文件,如果有就去加载info.plist文件,如果没有,那么应用程序加载完毕.</li>
<li>通知应用程序，调用代理方法</li>
</ol>
<h2><a id="uiappdelegate" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>UIAppDelegate</h2>
<p>所有的移动操作系统都有个致命的缺点:app很容易受到打扰。比如一个来电或者锁屏会导致app进入后台甚至被终止,还有很多其它类似的情况会导致app受到干扰,在app受到干扰时,会产生一些系统事件,</p>
<p>这时UIApplication会通知它的delegate对象,让delegate代理来处理这些系统事件</p>
<p>delegate可处理的事件包括:</p>
<ol>
<li>应用程序的生命周期事件(如程序启动和关闭)</li>
<li>系统事件(如来电)</li>
<li>内存警告<br />
...</li>
</ol>
<p>UIApplication会在程序一启动时候创建一个遵守UIApplicationDelegate的代理.</p>
<p>这个就是我们程序一创建时的AppDelegate类。AppDelegate就是遵守了UIApplicationDelegate协议。 在这个类中定义很多监听系统事件的方法.同时也定义了一些应用程序的生命周期方法.</p>
<pre><code class="language-swift">@implementation AppDelegate

// 1. 应用程序启动完成，会调用此方法，启动之后，将不再调用此方法！
// 如果因为内存等原因，应用程序被操作系统干掉，再次点击图标，会调用此方法！
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    NSLog(@&quot;应用程序启动&quot;);

    return YES;
}

// 2. 应用程序注销激活状态，游戏应该再次方法中暂停游戏进程！此方法在游戏开发中尤为重要！
- (void)applicationWillResignActive:(UIApplication *)application
{
    NSLog(@&quot;%s&quot;, __func__);

    // Sent when the application is about to move from active to inactive state. This can occur for certain types of temporary interruptions (such as an incoming phone call or SMS message) or when the user quits the application and it begins the transition to the background state.
    // Use this method to pause ongoing tasks, disable timers, and throttle down OpenGL ES frame rates. Games should use this method to pause the game.
}

// 3. 应用程序退出到后台，释放共享资源，保存用户数据，停止时钟，保存足够的应用程序状态信息...
- (void)applicationDidEnterBackground:(UIApplication *)application
{
    NSLog(@&quot;%s&quot;, __func__);
    // Use this method to release shared OC-UIApplication, save user data, invalidate timers, and store enough application state information to restore your application to its current state in case it is terminated later.
     // If your application supports background execution, this method is called instead of applicationWillTerminate: when the user quits.
}

// 4. 应用程序进入前台，如果在进入后台保存数据等操作，在此方法中，回复进入后台的操作
- (void)applicationWillEnterForeground:(UIApplication *)application
{
    NSLog(@&quot;%s&quot;, __func__);
    // Called as part of the transition from the background to the inactive state; here you can undo many of the changes made on entering the background.
}

// 5. 应用程序变成活动状态，重新启动原来暂停的状态
- (void)applicationDidBecomeActive:(UIApplication *)application
{
    NSLog(@&quot;%s&quot;, __func__);
    // Restart any tasks that were paused (or not yet started) while the application was inactive. If the application was previously in the background, optionally refresh the user interface.
}

// 6. 应用程序将被终止
- (void)applicationWillTerminate:(UIApplication *)application
{
    // Called when the application is about to terminate. Save data if appropriate. See also applicationDidEnterBackground:.
}

@end
</code></pre>
<h2><a id="%E6%A8%A1%E4%BB%BFuiapplication%E5%8D%95%E4%BE%8B" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>模仿UIApplication单例</h2>
<p>要求:程序一启动就创建创建对象.创建的对象只能通过share的方式获取对象.不能够进行alloc 操作,当执行alloc时, 程序发生崩溃</p>
<h4><a id="1%E7%A8%8B%E5%BA%8F%E4%B8%80%E5%90%AF%E5%8A%A8%E7%9A%84%E6%97%B6%E5%80%99%E5%B0%B1%E5%88%9B%E5%BB%BA%E5%AF%B9%E8%B1%A1" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>1.程序一启动的时候就创建对象.</h4>
<p>当类被加载到内存的时候就会调用<code>load</code>的方法,它会比<code>main</code>方法优先调用</p>
<pre><code class="language-swift">static Persion *_instance;
+ (void)load
{
    /// 想要保存创建的对象, 要用成员属性,但是现在是类方法, 没有办法访问成员属性,所以搞了一个static的静态变量进行保存
    /// 创建对象
    _instance = [[self alloc] init];
}
</code></pre>
<h4><a id="2%E4%BF%9D%E8%AF%81%E8%B0%83%E7%94%A8-alloc%E6%97%B6%E4%BC%9A%E4%BA%A7%E7%94%9F%E5%BC%82%E5%B8%B8%E9%87%8D%E5%86%99%E7%B3%BB%E7%BB%9F%E7%9A%84%E6%98%AF-alloc%E6%96%B9%E6%B3%95" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>2.保证调用alloc时会产生异常, 重写系统的是alloc方法</h4>
<pre><code class="language-swift">+(instancetype)alloc
{
    当调用alloc方法时,先查看一下_instance有没有值,如果已经有值的话,直接抛出异常.
    if(_instance)
    {
        NSException *exception = [NSException exceptionWithName:@&quot;NSInternalInconsistencyException&quot;
                                                     reason:@&quot;There can only be one Persion instance.&quot;
                                                   userInfo:nil];/// 抛出异常
        [exception raise];
    }
    /// 保持系统的做法.
    return [super alloc];
}
</code></pre>
<h4><a id="3%E9%80%9A%E8%BF%87-share%E6%96%B9%E5%BC%8F%E8%8E%B7%E5%8F%96%E5%AF%B9%E8%B1%A1" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>3.通过share方式获取对象</h4>
<pre><code class="language-swift">+ (instancetype)sharePersion
{
    return _instance
}
</code></pre>


    

      </div>

      <div class="row">
        <div class="large-6 columns">
        <p class="text-left" style="padding:15px 0px;">
      
          <a href="17001892555038.html" 
          title="Previous Post: CocoaPods安装和使用教程(更新至Mac High Sierra)">&laquo; CocoaPods安装和使用教程(更新至Mac High Sierra)</a>
      
        </p>
        </div>
        <div class="large-6 columns">
      <p class="text-right" style="padding:15px 0px;">
      
          <a  href="17001892554374.html" 
          title="Next Post: iOS 网络小结">iOS 网络小结 &raquo;</a>
      
      </p>
        </div>
      </div>
      <div class="comments-wrap">
        <div class="share-comments">
          

          

          
        </div>
      </div>
    </div><!-- article-wrap -->
  </div><!-- large 8 -->




 <div class="large-4 medium-4 columns">
  <div class="hide-for-small">
    <div id="sidebar" class="sidebar">
          <div id="site-info" class="site-info">
            
                <h1>DreamEverAfter</h1>
                <div class="site-des"></div>
                <div class="social">











  <a target="_blank" class="rss" href="atom.xml" title="RSS">RSS</a>
                
              	 </div>
          	</div>

             

              <div id="site-categories" class="side-item ">
                <div class="side-header">
                  <h2>Categories</h2>
                </div>
                <div class="side-content">

      	<p class="cat-list">
        
            <a href="Pages.html"><strong>Pages</strong></a>
        
            <a href="CS.html"><strong>CS</strong></a>
        
            <a href="List.html"><strong>List</strong></a>
        
            <a href="%E6%9D%82.html"><strong>杂</strong></a>
         
        </p>


                </div>
              </div>

              <div id="site-categories" class="side-item">
                <div class="side-header">
                  <h2>Recent Posts</h2>
                </div>
                <div class="side-content">
                <ul class="posts-list">
	      
		      
			      <li class="post">
			        <a href="17016988559065.html">差生文具多</a>
			      </li>
		     
		  
		      
			      <li class="post">
			        <a href="16996865532784.html">三汁焖锅</a>
			      </li>
		     
		  
		      
			      <li class="post">
			        <a href="17001172774052.html">别了，中国大陆的Kindle</a>
			      </li>
		     
		  
		      
			      <li class="post">
			        <a href="17001265068678.html">HomeBrew更新报错“fatal- Could not resolve HEAD to a revision”</a>
			      </li>
		     
		  
		      
			      <li class="post">
			        <a href="17001892553950.html">SwiftUI基本控件</a>
			      </li>
		     
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		   
		  		</ul>
                </div>
              </div>
        </div><!-- sidebar -->
      </div><!-- hide for small -->
</div><!-- large 4 -->

</div><!-- row -->

 <div class="page-bottom clearfix">
  <div class="row">
   <p class="copyright">Copyright &copy; 2015
Powered by <a target="_blank" href="http://www.mweb.im">MWeb</a>,&nbsp; 
Theme used <a target="_blank" href="http://github.com">GitHub CSS</a>.</p>
  </div>
</div>

        </section>
      </div>
    </div>



  













<script src="asset/prism.js"></script>


<style type="text/css">
figure{margin: 0;padding: 0;}
figcaption{text-align:center;}

/* PrismJS 1.14.0
 http://prismjs.com/download.html#themes=prism&languages=markup+css+clike+javascript */
/**
 * prism.js default theme for JavaScript, CSS and HTML
 * Based on dabblet (http://dabblet.com)
 * @author Lea Verou
 */

code[class*="language-"],
pre[class*="language-"] {
    color: black;
    background: none;
    text-shadow: 0 1px white;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;
    
    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;
    
    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
}

pre[class*="language-"]::-moz-selection, pre[class*="language-"] ::-moz-selection,
code[class*="language-"]::-moz-selection, code[class*="language-"] ::-moz-selection {
    text-shadow: none;
    background:#b3d4fc;
}

pre[class*="language-"]::selection, pre[class*="language-"] ::selection,
code[class*="language-"]::selection, code[class*="language-"] ::selection {
    text-shadow: none;
    background: #b3d4fc;
}

@media print {
    code[class*="language-"],
    pre[class*="language-"] {
        text-shadow: none;
    }
}

/* Code blocks */
pre[class*="language-"] {
    padding: 1em;
    margin: .5em 0;
    overflow: auto;
}

:not(pre) > code[class*="language-"],
pre[class*="language-"] {
    background: #F7F7F7;
}

/* Inline code */
:not(pre) > code[class*="language-"] {
    padding: .1em;
    border-radius: .3em;
    white-space: normal;
}

.token.comment,
.token.prolog,
.token.doctype,
.token.cdata {
    color: slategray;
}

.token.punctuation {
    color: #999;
}

.namespace {
    opacity: .7;
}

.token.property,
.token.tag,
.token.boolean,
.token.number,
.token.constant,
.token.symbol,
.token.deleted {
    color: #905;
}

.token.selector,
.token.attr-name,
.token.string,
.token.char,
.token.builtin,
.token.inserted {
    color: #690;
}

.token.operator,
.token.entity,
.token.url,
.language-css .token.string,
.style .token.string {
    color: #9a6e3a;
    background: hsla(0, 0%, 100%, .5);
}

.token.atrule,
.token.attr-value,
.token.keyword {
    color: #07a;
}

.token.function,
.token.class-name {
    color: #DD4A68;
}

.token.regex,
.token.important,
.token.variable {
    color: #e90;
}

.token.important,
.token.bold {
    font-weight: bold;
}
.token.italic {
    font-style: italic;
}

.token.entity {
    cursor: help;
}


pre[class*="language-"].line-numbers {
    position: relative;
    padding-left: 3.8em;
    counter-reset: linenumber;
}

pre[class*="language-"].line-numbers > code {
    position: relative;
    white-space: inherit;
}

.line-numbers .line-numbers-rows {
    position: absolute;
    pointer-events: none;
    top: 0;
    font-size: 100%;
    left: -3.8em;
    width: 3em; /* works for line-numbers below 1000 lines */
    letter-spacing: -1px;
    border-right: 1px solid #999;

    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;

}

    .line-numbers-rows > span {
        pointer-events: none;
        display: block;
        counter-increment: linenumber;
    }

        .line-numbers-rows > span:before {
            content: counter(linenumber);
            color: #999;
            display: block;
            padding-right: 0.8em;
            text-align: right;
        }

</style>

  
    

    <script src="asset/js/foundation.min.js"></script>
    <script>
      $(document).foundation();
      function fixSidebarHeight(){
        var w1 = $('.markdown-body').height();
          var w2 = $('#sidebar').height();
          if (w1 > w2) { $('#sidebar').height(w1); };
      }
      $(function(){
        fixSidebarHeight();
      })
      $(window).load(function(){
          fixSidebarHeight();
      });
     
    </script>



  </body>
</html>
